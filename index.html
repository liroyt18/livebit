<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>LiveBIT Connection Test</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        body { background: #080810; color: white; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .status-box { padding: 20px; border-radius: 15px; border: 2px solid #333; text-align: center; width: 80%; max-width: 500px; }
        .loading { color: orange; font-weight: bold; }
        .success { color: #00ff88; font-weight: bold; border-color: #00ff88; }
        .error { color: #ff2d55; font-weight: bold; border-color: #ff2d55; }
        #debug-info { margin-top: 20px; font-family: monospace; font-size: 12px; color: #888; text-align: left; background: #111; padding: 10px; width: 100%; overflow-x: auto; }
    </style>
</head>
<body>

    <div id="status-card" class="status-box">
        <h2>בדיקת חיבור לשרת</h2>
        <p id="status-msg" class="loading">מנסה להתחבר לשרת ב-Render...</p>
        <p id="server-url" style="font-size: 14px; color: #00e5ff;"></p>
    </div>

    <div id="debug-info">
        <b>יומן בדיקה (Debug):</b><br>
        <div id="log"></div>
    </div>

    <script>
        // וודא שהכתובת הזו היא בדיוק מה שמופיע לך ב-Render!
        const SERVER_URL = "https://livebit-server.onrender.com"; 
        document.getElementById('server-url').innerText = "כתובת השרת: " + SERVER_URL;

        function addLog(msg) {
            const logDiv = document.getElementById('log');
            logDiv.innerHTML += "> " + msg + "<br>";
        }

        addLog("מתחיל ניסיון חיבור ל-Socket.io...");

        const socket = io(SERVER_URL, {
            timeout: 10000,
            reconnectionAttempts: 3
        });

        socket.on('connect', () => {
            addLog("חיבור הצליח! ID: " + socket.id);
            document.getElementById('status-msg').innerText = "מחובר בהצלחה! השרת עובד.";
            document.getElementById('status-msg').className = "success";
        });

        socket.on('connect_error', (error) => {
            addLog("שגיאת חיבור: " + error.message);
            document.getElementById('status-msg').innerText = "נכשל להתחבר לשרת. הכתובת לא נכונה או שהשרת כבוי.";
            document.getElementById('status-msg').className = "error";
        });

        socket.on('disconnect', () => {
            addLog("החיבור נותק.");
        });

        // בדיקה אם השרת בכלל חי בדפדפן
        fetch(SERVER_URL).then(() => {
            addLog("השרת הגיב לבקשת HTTP פשוטה.");
        }).catch(err => {
            addLog("השרת לא מגיב בכלל (HTTP Fail).");
        });
    </script>
</body>
</html>
