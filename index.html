<audio id="tension-sound" preload="auto">
    <source src="tension.mp3" type="audio/mpeg">
</audio>

<script>
    const sound = document.getElementById('tension-sound');

    // פונקציה חדשה ש"משחררת" את החסימה של הדפדפן
    function unlockAudio() {
        sound.play().then(() => {
            sound.pause();
            sound.currentTime = 0;
            console.log("Audio unlocked and ready!");
        }).catch(e => console.log("Audio waiting for click"));
    }

    function doLogin() {
        // ... (הקוד הקודם של הלוגין)
        if(valid) { 
            unlockAudio(); // ברגע שלחצת על הכפתור, הסאונד מאושר להפעלה
            document.getElementById('login-screen').style.display = 'none'; 
            document.getElementById('admin-panel').style.display = 'grid'; 
        }
    }

    function toggleClock() {
        if(active) { 
            clearInterval(timerTask); active = false; 
            sound.pause(); 
        } else {
            active = true;
            timerTask = setInterval(() => {
                if(timeLeft > 0) {
                    timeLeft--;
                } else if(!isSnipeMode) {
                    isSnipeMode = true;
                    timeLeft = parseInt(document.getElementById('snipe-input').value);
                    
                    // הפעלה כפויה של הסאונד
                    sound.currentTime = 0;
                    let playPromise = sound.play();
                    if (playPromise !== undefined) {
                        playPromise.catch(error => {
                            console.log("Playback failed:", error);
                        });
                    }
                } else {
                    clearInterval(timerTask); active = false;
                    sound.pause();
                }
                updateUI();
            }, 1000);
        }
    }
</script>
